// admin.js v2.9
// 
// http://admin.nln.me
// @author ghy
// @contact qq 249398279
// build: 2015-12-29
// 
var Ut=function(){return Ut={getParam:function(a){var b=window.location.search,c={},d=b.replace("?","").split("&");for(var e in d){var f=d[e];c[f.split("=")[0]]=f.split("=")[1]}return null!=a?c[a]:c},gettime:function(a){var b=null;if(null!=a&&0!=a.length){var c=a.split(" ");if(null!=c&&c.length>1){var d=(c[0]||"-").split("-"),e=d[0],f=Number(d[1])-1,g=d[2],h=c[1].split(":"),i=h[0],j=h[1];b=new Date(e,f,g,i,j).getTime()}return b}},Null:function(a){return null==a||""==a||0==a.length},isURL:function(a){return null==a.match(/(http[s]?|ftp):\/\/[^\/\.]+?\..+(\w|\/)$/i)?!1:!0},getTimeTostr:function(a){var b="",a=Number(a)||-1;if(a>0){var c=new Date(a),d=c.getMonth()+1;d=10>d?"0"+d:d;var e=c.getDate();e=10>e?"0"+e:e;var f=c.getHours();f=10>f?"0"+f:f;var g=c.getMinutes();g=10>g?"0"+g:g,b=c.getFullYear()+"-"+d+"-"+e+" "+f+":"+g}return b},search:function(a,b){var c=Ut.getParam();c[a]=b;var d=[];for(var e in c)null!=e&&e.length>0&&d.push(e+"="+c[e]);var f=d.join("&");return f}}}(),CssTool={makstyle:function(a){var b=this.getstyle(a);$('<style type="text/css">'+b+"</style>").appendTo("head")},getstyle:function(a){for(var b="",c=this._getstyleArray(a),d=0;d<c.length;d++)for(var e=c[d],f=e.length-1;f>=0;f--){var g=e[f];for(var h in g){var i=h.replace(/[#]/gi," #").replace(/[\.]/gi," .").replace(/&\s/gi,"&").replace(/&/gi,""),j=g[h];b+=i+"{"+j+"}"}}return b=b.replace(/^\s/gi,"")},_getstyleArray:function(a){var b=[];for(var c in a){var d=this._getyles(c,a[c]);b.push(d)}return b},_getyles:function(a,b){function c(a,b){var e={};for(var f in b)/[#\.&]/gi.test(f)&&"object"==typeof b[f]?c(a+f,b[f]):e[a]=(e[a]||"")+f+":"+b[f]+";";d.push(e)}var d=[];return c(a,b),d}};jQuery.fn.zen=function(a,b){var c=$(this);return void 0==typeof a?c:(a.replace(/^([^>+]+)(([>+])(.*))?/,function(a,d,e,f,g){d.replace(/^([^*]+)(\*([0-9]+))?/,function(a,d,e,h){void 0==h&&(h=1),1>h&&(h=1);for(var i=d.match(/[^.#]+/)[0],j=1;h>=j;j++){var k=$("<"+i+">");d.replace(/([.#])([^.#]+)/g,function(a,b,c){"#"==b?k.attr("id",c):"."==b&&k.addClass(c)}),c.append(k),void 0==f?void 0!=b&&jQuery.each([k],b):"+"==f?c.zen(g,b):">"==f&&k.zen(g,b)}})}),$(this))},window.zen=function(a,b){var c=$("<span>").zen(a,b).html();return $(c)},window.fytip=function(a){var b,c=!1,d=!1,e={init:function(){this.layout(),this.initEvent()},layout:function(){var b={".fy-slide-tip":{position:"fixed",padding:"5px","z-index":"1000","font-size":"12px","line-height":"1.4",opacity:"0.95",top:"0px",".arrow":{position:"absolute",width:"0",height:"0","border-color":"transparent","border-style":"solid","border-width":"5px 5px 5px 5px","&.top-arrow":{left:"50%",bottom:"-5px","margin-left":"-5px","border-top-color":"#425160"},"&.right-arrow":{top:"50%",left:"-5px","margin-top":"-5px","border-right-color":"#425160"}},".tip-inner":{"max-width":"400px",padding:"12px 8px",color:"#fff","text-align":"center","text-decoration":"none","border-radius":"0",background:"#163342"}}};a(".fy-tip").length&&CssTool.makstyle(b)},initEvent:function(){a(".fy-tip").on({mouseenter:function(){c=!0;var b=a(f.getSinleton()),d=a(this).offset().top,e=a(this).offset().left,g=a(this).innerWidth(),h=a(this).innerHeight(),i=a(this).attr("data-tip")||"top",j=a(this).attr("data-desc");"content"==j&&(j=a(this).html()),f.reset(),b.find(".arrow").addClass(i+"-arrow"),b.find(".tip-inner").html(j);var k=b.width(),l=b.height();"top"==i&&b.css({left:e-(k-g+5)/2,top:d-l-10}),"right"==i&&(b.css({left:e+g+2,top:d-(l-h)/2-5}),b.addClass("")),b.show()},mouseleave:function(){c=!1,setTimeout(function(){if(!c&&!d){var b=a(f.getSinleton());b.hide()}},50)}}),a(document).on("mouseenter",".fy-slide-tip",function(){d=!0}),a(document).on("mouseleave",".fy-slide-tip",function(){d=!1;var b=a(f.getSinleton());b.hide()})},reset:function(){var b=a(f.getSinleton()).find(".arrow");b.removeClass("top-arrow"),b.removeClass("right-arrow"),b.removeClass("left-arrow"),b.removeClass("bottom-arrow")},getSinleton:function(){function c(){return null==b&&(b=new d),b}function d(){var b=document.createElement("div");return a(b).addClass("fy-slide-tip"),a(b).append(a('<div class="arrow"></div>')),a(b).append(a('<div class="tip-inner"></div>')),a("body").append(b),b}return c()}},f=e;return e}($),$(document).ready(function(){fytip.init()});var alertStyle={"#zalert":{display:"none","font-family":"'微软雅黑'",top:"0",left:"0",width:"100%",height:"100%",position:"fixed","z-index":"99999"},"#zalert .bk":{opacity:"0.5",width:"100%",height:"100%",background:"#000",filter:"alpha(opacity=50)"},"#zalert .z-close":{position:"absolute",right:"8px","font-size":"24px",top:"0px",color:"#B3B2B2",cursor:"pointer"},"#zalert .z-close:hover":{color:"#5F5A5A"},"#zalert .panel":{background:"#FFF","border-radius":"3px",position:"fixed","z-index":"99999999",width:"400px","min-height":"100px",padding:"15px 20px",left:"50%",top:"25%","margin-left":"-200px"},"#zalert .info":{margin:"30px auto","text-align":"center","font-size":"14px",height:"24px","line-height":"24px",width:"100%"},"#zalert .zbtn":{width:"60px",border:"1px solid #df1155",color:"#fff","background-color":"#f71d65","font-size":"14px","text-align":"center",cursor:"pointer",margin:"0px auto 20px",top:"25%",padding:"2px 5px"},"#zalert .zbtn:hover":{"background-color":"#FD4884"}};window.zalert=function(){var a={init:function(){this.cstyle(),this.initEvent(),this.cpage()},cstyle:function(){$('<style type="text/css">'+a.getstyle(alertStyle)+"</style>").appendTo("head")},cpage:function(){var a=zen("div#zalert>div.bk+div.panel"),b=$(a).find(".panel");b.zen("div.title-wrap>div.z-title+div.z-close"),b.zen("div.content>div.info+div.zbtn"),$(b).find(".z-close").html("×"),$(b).find(".z-title").html("来自章鱼tv的提示"),$(b).find(".zbtn").html("确定"),$("body").append(a)},initEvent:function(){$(document).on("click","#zalert .zbtn,#zalert .z-close",function(){$("#zalert").hide()})},alert:function(a,b){$("#zalert").fadeIn(),$("#zalert .info").html(a)},getstyle:function(a){function b(a){var b="";for(var c in a)if(/[#\.]/gi.test(c)&&"object"==typeof a[c]){var d=a[c],e="";for(var f in d)e+=f+":"+d[f]+";";b+=c+"{"+e+"}"}return b}var c=b(a);return c}};return $(document).ready(function(){a.init()}),function(b,c){a.alert(b,c)}}();var Admins=function(){var a={init:function(){this.load(),this.layout(),this.initEvent()},layout:function(){$(".time").each(function(){var a=$(this).attr("time");if(Ut){var b=Ut.getTimeTostr(a);$(this).html(b)}});var a=$("#start-time").attr("start")||Ut.getParam("start"),b=$("#end-time").attr("end")||Ut.getParam("end");if(null!=a){10==a.length&&(a=1e3*Number(a));var a=new Date(Number(a)),c=Ut.getTimeTostr(a);$("#start-time").val(c)}if(null!=b){10==b.length&&(b=1e3*Number(b));var b=new Date(Number(b)),d=Ut.getTimeTostr(b);$("#end-time").val(d)}},initEvent:function(){$("table").on("click",".trup",function(){var a=$(this).parent().parent(),b=$(a).prev();b.before(a)}),$("table").on("click",".trdown",function(){var a=$(this).parent().parent(),b=$(a).next();b.after(a)}),$("table").on("click",".trdel",function(){var a=$(this).parent().parent();a.remove()}),$(".nav-tabs").on("click","li a",function(){$(this).parent().parent().find(".active").removeClass("active"),$(this).parent().addClass("active");var a=$(this).attr("data-id");$(".nav-content").removeClass("active"),$("#"+a).addClass("active")})},load:function(){0==$(".topbar").length&&("undefined"!=typeof AdminPage&&null!=AdminPage?setTimeout(function(){a.cpage(AdminPage)},10):$.ajax({url:"/api/getadminpagelink",type:"post",data:{},dataType:"json",success:function(b){a.cpage(b)}}))},cpage:function(b){if(b){var c="",d="",e="";if("undefined"!=typeof AdminConf)c=AdminConf.top,d=AdminConf.tag,e=AdminConf.link;else{var f=a.getCurrentPage(b);c=f.ctop,d=f.ctag,e=f.clink}var g=zen("div.topbar>div.topbar-left.left-home>a>i.fa.fa-home.fa-3x"),h=zen("div.topbar-left");g.append(h),g.find("a").attr("href","/admin"),$("body").prepend(g),$("#content").wrap(zen("div.main-content>div.content-inner.left-content>div.content-body"));var i=$(".main-content");i.zen("div.left-slide-bar>ul");var j=i.find(".left-slide-bar"),k=$(".content-inner");k.zen("div.inner-slide-bar>div.list");var l=k.find(".inner-slide-bar"),m=null;for(var n in b){var o=b[n],p=o.name,q=o.url,r=$("<div><a href='"+q+"'><span></span></a></div>");r.addClass("topbar-nav-btn"),r.find("a").attr("src",q),r.find("span").html(p),$(h).append(r),p==c&&(m=o,r.addClass("active"));for(var s=zen("div.dropdown-menu"),t=o.tag||[],n=0;n<t.length;n++){for(var u=zen("div.topbar-nav-col>div.col-title+ul"),v=t[n].links||[],w=0;w<v.length;w++){var x=v[w].url,p=v[w].name,y=$("<li ><a href='"+x+"'>"+p+"</a></li>");$(u).find("ul").append(y)}s.append(u)}r.append(s)}var z=null;if(null!=m&&null!=m.tag)for(var A=0;A<m.tag.length;A++){var B=m.tag[A],C=$("<li><a href='"+B.url+"'>"+B.name+"</a></li>");j.find("ul").append(C),B.name==d&&(C.addClass("active"),z=B)}if(null!=z&&null!=z.links&&z.links.length>0){for(var D=$("<ul></ul>"),E=z.title||p,n=0;n<z.links.length;n++){var F=z.links[n],y=$("<li><a href='"+F.url+"'><div class='link'>"+F.name+"</div></a></li>");D.append(y),F.name==e&&y.find("a").addClass("current")}l.find(".list").append(D),l.append("<div class='title'>"+E+"</div>")}}},getCurrentPage:function(a){var b=window.location.pathname,c=window.location.href,d=window.location.host,e="",f="",g="",h={};for(var i in a)for(var j=a[i],k=0;k<j.tag.length;k++)for(var l=j.tag[k],m=0;m<l.links.length;m++){var n=l.links[m];(n.url==b||"http://"+d+n.url==c)&&(e=j.name,f=l.name,g=n.name,h.ctop=e,h.ctag=f,h.clink=g)}return h}},b={init:function(){a.init()}};return b}();$(document).ready(function(){Admins.init()});